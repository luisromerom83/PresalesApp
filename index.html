<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presales LatinTool</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="assets/logo_shield.svg">
</head>

<body>
    <div class="app-container">
        <header>
            <div class="header-left">
                <button id="back-btn" class="back-btn hidden" title="Volver" data-i18n="btn_back"
                    data-i18n-prop="title">&larr;</button>
                <img src="assets/logo_shield.svg" alt="Logo" class="app-logo">
                <h1 id="app-title" data-i18n="app_title">Presales LatinTool</h1>
            </div>
            <div class="header-right">
                <div id="update-badge" class="update-badge hidden" title="Nueva actualizaci√≥n disponible"
                    data-i18n="update_available" data-i18n-prop="title">
                    <span class="badge-icon">‚òÅÔ∏è</span>
                    <span class="badge-text" data-i18n="update_badge_text">Update</span>
                </div>
                <button id="help-btn" class="help-btn" title="Manual de Ayuda" data-i18n="help_manual"
                    data-i18n-prop="title">?</button>
                <div class="header-user-info">
                    <span id="header-display-name" data-i18n="user_name"
                        style="font-weight: 600; color: var(--brand-orange);">Usuario</span>
                    <span id="header-display-company" data-i18n="company_name"
                        style="font-size: 0.8rem; color: var(--text-secondary);">Empresa</span>
                </div>
                <div class="header-logo">
                    <img src="assets/logo.svg" alt="Quadient Logo" class="theme-logo">
                </div>
            </div>
        </header>

        <main>
            <!-- Screen 1: Directory Selection -->
            <section id="directory-screen" class="screen active">
                <div class="card center-content">
                    <img src="assets/logo.svg" alt="Quadient Logo" class="entry-logo theme-logo">
                    <h2 data-i18n="init_config_title">Configuraci√≥n Inicial</h2>
                    <p data-i18n="init_config_desc">Selecciona el directorio donde se alojar√°n todos los archivos de
                        configuraci√≥n (JSON).</p>
                    <button id="select-dir-btn" class="primary-btn" data-i18n="btn_select_dir">Seleccionar
                        Directorio</button>
                    <p id="selected-path" class="path-display" data-i18n="path_not_selected"></p>
                    <button id="continue-btn" class="secondary-btn hidden" data-i18n="btn_continue">Continuar</button>
                </div>
            </section>

            <!-- Screen 2: Data Form -->
            <section id="form-screen" class="screen">
                <div class="card center-content">
                    <img src="assets/logo.svg" alt="Quadient Logo" class="entry-logo theme-logo">
                    <h2 data-i18n="user_data_title">Datos de Usuario</h2>
                    <form id="user-form">
                        <div class="form-group">
                            <label for="name" data-i18n="label_full_name">Nombre Completo</label>
                            <input type="text" id="name" required placeholder="Ej. Juan P√©rez"
                                data-i18n="placeholder_full_name" data-i18n-prop="placeholder">
                        </div>
                        <div class="form-group">
                            <label for="email" data-i18n="label_email">Correo Electr√≥nico</label>
                            <input type="email" id="email" required placeholder="juan@ejemplo.com"
                                data-i18n="placeholder_email" data-i18n-prop="placeholder">
                        </div>
                        <div class="form-group">
                            <label for="company" data-i18n="label_company">Empresa</label>
                            <input type="text" id="company" placeholder="Nombre de tu empresa"
                                data-i18n="placeholder_company" data-i18n-prop="placeholder">
                        </div>
                        <div class="form-actions">
                            <button type="button" id="back-to-dir-btn" class="text-btn"
                                data-i18n="btn_back">Volver</button>
                            <button type="submit" class="primary-btn" data-i18n="btn_enter">Entrar</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Screen 3: Main Screen -->
            <section id="main-screen" class="screen main-screen">
                <div class="main-layout">
                    <aside class="sidebar">
                        <nav>
                            <div id="opp-group-container">
                                <div class="nav-group-label" id="toggle-opp-group">
                                    <span data-i18n="sidebar_opps">Oportunidades</span><span
                                        class="toggle-icon">‚ñæ</span>
                                </div>
                                <div id="opp-group-submenu" class="submenu">
                                    <button class="nav-btn active" data-target="opp-list-view" id="all-opps-btn"
                                        data-i18n="sidebar_all">Todas</button>
                                    <button class="nav-btn" data-target="opp-list-view" id="favorites-nav-btn"
                                        data-i18n="sidebar_favorites">‚≠ê
                                        Favoritos</button>
                                    <div id="dynamic-filters-container">
                                        <!-- Dynamic groups injected here -->
                                    </div>
                                </div>
                            </div>

                            <div
                                style="margin-top: 1rem; border-top: 1px solid var(--glass-border); padding-top: 1rem;">
                                <button class="nav-btn" data-target="activity-calendar-view" id="calendar-nav-btn"
                                    data-i18n="sidebar_calendar">Calendario de Actividades</button>
                                <button class="nav-btn" data-target="global-contacts-view"
                                    data-i18n="sidebar_contacts">Contactos</button>
                                <button class="nav-btn" data-target="accounts-with-plan-view"
                                    data-i18n="sidebar_account_plans">Planes de Cuenta</button>
                                <button class="nav-btn" data-target="notes-history-view"
                                    data-i18n="sidebar_history">Historial</button>
                                <button class="nav-btn" data-target="resources-view"
                                    data-i18n="sidebar_resources">Recursos</button>

                                <div id="ms-group-container">
                                    <div class="nav-group-label" id="toggle-ms-group">
                                        <span>Microsoft</span><span class="toggle-icon">‚ñæ</span>
                                    </div>
                                    <div id="ms-group-submenu" class="submenu">
                                        <button class="nav-btn" data-target="todo-view" id="todo-nav-btn">Microsoft
                                            To-Do</button>
                                        <button class="nav-btn" data-target="calendar-ms-view"
                                            id="calendar-ms-nav-btn">Microsoft Calendar</button>
                                    </div>
                                </div>

                                <button class="nav-btn" data-target="settings-view"
                                    data-i18n="sidebar_settings">Configuraci√≥n</button>
                            </div>
                        </nav>
                        <div id="app-version" class="sidebar-version">v1.0.0</div>
                    </aside>

                    <div class="content">
                        <!-- Notes History View -->
                        <div id="notes-history-view" class="view">
                            <div class="toolbar">
                                <h2 data-i18n="view_title_history">Historial Global de Notas</h2>
                            </div>
                            <div class="history-container">
                                <section class="history-group">
                                    <h3 data-i18n="history_this_week">Esta Semana</h3>
                                    <div id="history-week" class="history-list"></div>
                                </section>
                                <section class="history-group">
                                    <h3 data-i18n="history_this_month">Este Mes</h3>
                                    <div id="history-month" class="history-list"></div>
                                </section>
                                <section class="history-group">
                                    <h3 data-i18n="history_this_year">Este A√±o</h3>
                                    <div id="history-year" class="history-list"></div>
                                </section>
                            </div>
                        </div>

                        <!-- Microsoft To-Do View -->
                        <div id="todo-view" class="view">
                            <webview src="https://to-do.office.com/tasks/" id="todo-webview" partition="persist:todo">
                            </webview>
                        </div>

                        <!-- Microsoft Calendar View -->
                        <div id="calendar-ms-view" class="view">
                            <webview src="https://outlook.office.com/calendar/" id="calendar-ms-webview"
                                partition="persist:todo">
                            </webview>
                        </div>
                        <!-- Opportunities View -->
                        <div id="opp-list-view" class="view active">
                            <div class="toolbar">
                                <h2 id="opp-view-title" data-i18n="view_title_opps">Oportunidades</h2>
                                <div class="search-container">
                                    <input type="text" id="opp-search-input"
                                        placeholder="Buscar por nombre, ID o cuenta..."
                                        data-i18n="placeholder_search_opps" data-i18n-prop="placeholder">
                                </div>
                                <button id="add-general-note-btn" class="secondary-btn small" title="Notas Generales"
                                    data-i18n="btn_general_notes" data-i18n-prop="title">üìù</button>
                                <label class="csv-upload-btn primary-btn small">
                                    <span data-i18n="btn_import_csv">Importar CSV</span>
                                    <input type="file" id="csv-input" accept=".csv" hidden>
                                </label>
                            </div>

                            <div class="table-container">
                                <table id="opp-table">
                                    <thead id="opp-table-head">
                                        <!-- Dynamic headers -->
                                    </thead>
                                    <tbody id="opp-list-body">
                                        <!-- Rows injected here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Activity Calendar View -->
                        <div id="activity-calendar-view" class="view">
                            <div class="toolbar calendar-toolbar">
                                <h2 data-i18n="view_title_calendar">Calendario de Actividades</h2>
                                <div class="calendar-controls">
                                    <div class="calendar-view-switcher">
                                        <button class="view-btn small" data-view="agenda"
                                            data-i18n="cal_btn_agenda">Agenda</button>
                                        <button class="view-btn small" data-view="day"
                                            data-i18n="cal_btn_day">D√≠a</button>
                                        <button class="view-btn small" data-view="work-week"
                                            data-i18n="cal_btn_work_week">Semana (L-V)</button>
                                        <button class="view-btn small" data-view="full-week"
                                            data-i18n="cal_btn_full_week">Semana Completa</button>
                                        <button class="view-btn small active" data-view="month"
                                            data-i18n="cal_btn_month">Mes</button>
                                    </div>
                                    <div class="calendar-nav">
                                        <button id="prev-month-btn" class="secondary-btn small">&larr;</button>
                                        <h3 id="current-month-display">Mes A√±o</h3>
                                        <button id="next-month-btn" class="secondary-btn small">&rarr;</button>
                                    </div>
                                </div>
                            </div>
                            <div class="calendar-container">
                                <div class="calendar-header-grid">
                                    <div data-i18n="day_sun">Dom</div>
                                    <div data-i18n="day_mon">Lun</div>
                                    <div data-i18n="day_tue">Mar</div>
                                    <div data-i18n="day_wed">Mi√©</div>
                                    <div data-i18n="day_thu">Jue</div>
                                    <div data-i18n="day_fri">Vie</div>
                                    <div data-i18n="day_sat">S√°b</div>
                                </div>
                                <div id="calendar-grid" class="calendar-grid">
                                    <!-- Days injected here -->
                                </div>
                            </div>
                        </div>

                        <!-- Global Contacts View -->
                        <div id="global-contacts-view" class="view">
                            <div class="toolbar">
                                <h2 data-i18n="view_title_contacts">Contactos Globales</h2>
                                <div class="search-container">
                                    <input type="text" id="contacts-search-input" placeholder="Buscar contactos..."
                                        data-i18n="placeholder_search_contacts" data-i18n-prop="placeholder"
                                        class="form-input">
                                </div>
                            </div>
                            <div class="table-container">
                                <table id="global-contacts-table">
                                    <thead>
                                        <tr>
                                            <th>Nombre</th>
                                            <th>Posici√≥n</th>
                                            <th>Email</th>
                                            <th>Tel√©fono</th>
                                            <th>Influencia</th>
                                            <th>Cuenta</th>
                                            <th>Notas</th>
                                        </tr>
                                    </thead>
                                    <tbody id="global-contacts-body">
                                        <!-- Contacts injected here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Accounts with Plan View -->
                        <div id="accounts-with-plan-view" class="view">
                            <div class="toolbar">
                                <h2 data-i18n="view_title_account_plans">Cuentas con Plan de Ataque</h2>
                            </div>
                            <div id="accounts-with-plan-list" class="opp-groups-container"
                                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;">
                                <!-- Account plan cards injected here -->
                            </div>
                        </div>

                        <!-- Resources View -->
                        <div id="resources-view" class="view">
                            <div class="toolbar">
                                <h2 data-i18n="view_title_resources">Recursos Globales</h2>
                                <div class="search-container">
                                    <input type="text" id="resources-search-input" placeholder="Buscar recursos..."
                                        data-i18n="placeholder_search_resources" data-i18n-prop="placeholder"
                                        class="form-input">
                                </div>
                                <button id="add-resource-btn" class="primary-btn small"
                                    data-i18n="btn_add_resource">A√±adir Recurso</button>
                            </div>
                            <div class="table-container">
                                <table id="resources-table">
                                    <thead>
                                        <tr>
                                            <th data-i18n="label_resource_name">Nombre</th>
                                            <th data-i18n="label_resource_content">Enlace / Email / Nota</th>
                                            <th style="width: 100px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody id="resources-body">
                                        <!-- Resources injected here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Settings View -->
                        <div id="settings-view" class="view">
                            <div class="toolbar">
                                <h2 data-i18n="view_title_settings">Configuraci√≥n</h2>
                            </div>

                            <div class="settings-tabs">
                                <button class="settings-tab-btn active" data-tab="settings-general"
                                    data-i18n="settings_tab_general">General</button>
                                <button class="settings-tab-btn" data-tab="settings-classifications"
                                    data-i18n="settings_tab_classifications">Clasificaciones</button>
                                <button class="settings-tab-btn" data-tab="settings-sidebar-filters"
                                    data-i18n="settings_tab_sidebar">Filtros
                                    Sidebar</button>
                                <button class="settings-tab-btn" data-tab="settings-api"
                                    data-i18n="settings_tab_api">API / Integraci√≥n</button>
                                <button class="settings-tab-btn" data-tab="settings-structure"
                                    data-i18n="settings_tab_structure">Estructura CSV</button>
                            </div>

                            <!-- Tab 1: General -->
                            <div id="settings-general" class="tab-pane active">
                                <div class="card settings-card">
                                    <div class="form-group">
                                        <label data-i18n="label_theme">Tema Visual</label>
                                        <select id="theme-select" class="form-input">
                                            <option value="auto">Sistema (Auto)</option>
                                            <option value="light">Claro (Blanco)</option>
                                            <option value="dark">Oscuro (Negro)</option>
                                            <option value="nordic">Nordic Frost</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-i18n="label_language">Lenguaje / Language</label>
                                        <select id="language-select" class="form-input">
                                            <option value="es_MX">Espa√±ol (MX)</option>
                                            <option value="pt_BR">Portugu√™s (BR)</option>
                                            <option value="en_US">English (US)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-i18n="label_work_dir">Carpeta de Trabajo</label>
                                        <div class="path-display" id="settings-path-display"
                                            data-i18n="path_not_selected" style="display: block; margin-bottom: 1rem;">
                                            No seleccionada</div>
                                        <button id="change-dir-btn" class="secondary-btn small"
                                            data-i18n="btn_change_dir">Cambiar Carpeta</button>
                                    </div>
                                    <div class="form-group">
                                        <label for="crm-url-template">Plantilla de URL Oportunidad (CRM)</label>
                                        <p class="sub-text">Ejemplo: https://mycrm.com/{Opportunity ID}/view</p>
                                        <input type="text" id="crm-url-template" placeholder="https://...">
                                    </div>
                                    <div class="form-group">
                                        <label for="account-url-template">Plantilla de URL Account</label>
                                        <p class="sub-text">Ejemplo: https://mycrm.com/account/{Account Name}</p>
                                        <input type="text" id="account-url-template" placeholder="https://...">
                                    </div>
                                </div>
                            </div>

                            <!-- Tab 2: Classifications -->
                            <div id="settings-classifications" class="tab-pane">
                                <div class="card settings-card">
                                    <h3>Clasificaciones de Cuenta</h3>
                                    <p class="sub-text" style="margin-bottom: 1rem;">Administra las categor√≠as
                                        disponibles para clasificar cuentas.</p>
                                    <div id="classification-manager-list" style="margin-bottom: 1rem;">
                                        <!-- Categories injected here -->
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="text" id="new-classification-input"
                                            placeholder="Nueva categor√≠a..." class="form-input">
                                        <button id="add-classification-btn" class="secondary-btn">A√±adir</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Tab 3: Sidebar Filters -->
                            <div id="settings-sidebar-filters" class="tab-pane">
                                <div class="card settings-card">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <h3>Filtros del Sidebar</h3>
                                        <button id="add-sidebar-filter-btn" class="secondary-btn small">+ Nuevo
                                            Grupo</button>
                                    </div>
                                    <p class="sub-text" style="margin-bottom: 1.5rem;">Crea grupos de filtrado basados
                                        en columnas del CSV o reglas l√≥gicas.</p>
                                    <div id="sidebar-filters-manager-list">
                                        <!-- Dynamic filters management cards injected here -->
                                    </div>
                                </div>
                            </div>
                            <div id="settings-api" class="tab-pane">
                                <div class="card settings-card">
                                    <h3>Integraci√≥n Front Office (API)</h3>
                                    <p class="sub-text" style="margin-bottom: 1rem;">Configura el endpoint y Token de
                                        Autorizaci√≥n para generar tickets.</p>
                                    <div class="form-group">
                                        <label for="fo-api-url">Base URL (Front Office)</label>
                                        <p class="sub-text">Ejemplo: https://company.quadientcloud.eu/</p>
                                        <input type="text" id="fo-api-url" placeholder="https://...">
                                    </div>
                                    <div class="form-group">
                                        <label for="fo-api-token">API KEY</label>
                                        <input type="password" id="fo-api-token" placeholder="Introduce tu API KEY...">
                                    </div>
                                    <div class="form-group">
                                        <label for="fo-api-template">Plantilla PoC (Resource Path)</label>
                                        <p class="sub-text">Ejemplo:
                                            icm:S:Production:S:UserResource//Interactive/StandardPackage/Templates/MyPoCTemplate.jld
                                        </p>
                                        <input type="text" id="fo-api-template"
                                            placeholder="ej: root:S:Production//Templates/MyTemplate.jld">
                                    </div>
                                    <div class="form-group">
                                        <label for="fo-api-holder">Holder por Defecto (User Name)</label>
                                        <p class="sub-text">Nombre de usuario que recibir√° el ticket (ej: j.perez)</p>
                                        <input type="text" id="fo-api-holder" placeholder="Usuario de FO...">
                                    </div>
                                </div>
                            </div>

                            <!-- Tab 4: CSV Structure -->
                            <div id="settings-structure" class="tab-pane">
                                <div class="card settings-card">
                                    <h3>Estructura de Datos (CSV)</h3>
                                    <p class="sub-text" style="margin-bottom: 1rem;">Define las columnas que esperas en
                                        tu CSV y sus valores de ejemplo.</p>
                                    <div class="table-container small" style="margin-bottom: 1rem;">
                                        <table id="structure-table">
                                            <thead>
                                                <tr>
                                                    <th>Campo (Header)</th>
                                                    <th>Muestra</th>
                                                    <th>Tipo</th>
                                                    <th>Vista</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody id="structure-body"></tbody>
                                        </table>
                                    </div>
                                    <div class="form-actions" style="margin-top: 1rem; gap: 1rem; display: flex;">
                                        <button id="add-structure-row-btn" class="secondary-btn small">+ Agregar
                                            Campo</button>
                                        <button id="download-sample-btn" class="secondary-btn small">Descargar
                                            Muestra</button>
                                        <button id="reset-structure-btn" class="secondary-btn small"
                                            style="background: rgba(255, 66, 0, 0.1); color: var(--brand-orange); border-color: var(--brand-orange);">Restablecer
                                            Est√°ndar</button>
                                        <button id="save-structure-btn" class="primary-btn small">Guardar
                                            Estructura</button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 2rem;">
                                <button id="save-settings-btn" class="primary-btn" data-i18n="btn_save_settings">Guardar
                                    Ajustes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Modal for Notes -->
            <div id="notes-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="modal-opp-name">Oportunidad</h3>
                        <button id="close-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div id="modal-opp-details-grid" class="opp-details-grid">
                            <div><strong>ID:</strong> <span id="modal-opp-id" class="dynamic-link"></span></div>
                            <div><strong>Account:</strong> <span id="modal-opp-account"></span></div>
                        </div>

                        <div class="notes-section">
                            <h4>Historial de Notas</h4>
                            <div id="notes-list" class="notes-history">
                                <!-- Notes injected here -->
                            </div>

                            <div class="add-note">
                                <textarea id="new-note-input" placeholder="Escribe una nueva nota..."></textarea>
                                <button id="add-note-btn" class="primary-btn">Agregar Nota</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Consolidated Modal for Activities (PoCs, RFPs, Demos) -->
            <div id="activities-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="activities-modal-title">Actividades</h3>
                        <button id="close-activities-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-tabs">
                        <button class="tab-btn active" data-tab="tab-pocs">üß™ PoCs</button>
                        <button class="tab-btn" data-tab="tab-rfp">üìÑ RFPs / RFIs</button>
                        <button class="tab-btn" data-tab="tab-demo">üìΩÔ∏è Demos</button>
                    </div>
                    <div class="modal-body">
                        <!-- PoCs Tab Content -->
                        <div id="tab-pocs" class="tab-content active">
                            <div class="toolbar-inline">
                                <span id="activities-opp-info-poc" class="sub-text"></span>
                                <button id="add-poc-row-btn" class="primary-btn small">+ Nueva PoC</button>
                            </div>
                            <div class="table-container small">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Descripci√≥n</th>
                                            <th>Inicio</th>
                                            <th>Responsable</th>
                                            <th style="text-align: right;">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pocs-list-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- RFP Tab Content -->
                        <div id="tab-rfp" class="tab-content">
                            <div class="toolbar-inline">
                                <span id="activities-opp-info-rfp" class="sub-text"></span>
                            </div>
                            <div class="form-group">
                                <label><img src="assets/cloud-icon.svg" class="onedrive-icon"> Documentaci√≥n</label>
                                <div class="url-field-wrapper">
                                    <input type="text" id="rfp-url" placeholder="https://..." class="url-input">
                                    <div id="rfp-url-preview" class="url-preview hidden">
                                        <a href="#" class="url-link" target="_blank">Abrir link</a>
                                        <button type="button" class="text-btn edit-url-btn">(Editar)</button>
                                    </div>
                                </div>
                            </div>
                            <h4>Actividades y Seguimiento</h4>
                            <div class="table-container small">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Actividad / Responsable</th>
                                            <th>Comentarios</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="rfp-activities-body"></tbody>
                                </table>
                            </div>
                            <button id="add-rfp-activity-btn" class="secondary-btn small" style="margin-top: 1rem;">+
                                Agregar Actividad</button>
                            <div class="form-actions" style="margin-top: 2rem;">
                                <button id="save-rfp-btn" class="primary-btn">Guardar RFP</button>
                            </div>
                        </div>

                        <!-- Demo Tab Content -->
                        <div id="tab-demo" class="tab-content">
                            <div class="toolbar-inline">
                                <span id="activities-opp-info-demo" class="sub-text"></span>
                            </div>
                            <div class="form-group">
                                <label>Descripci√≥n de la Demo Solicitada</label>
                                <textarea id="demo-desc" placeholder="..." rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label><img src="assets/cloud-icon.svg" class="onedrive-icon"> Material</label>
                                <div class="url-field-wrapper">
                                    <input type="text" id="demo-url" placeholder="https://..." class="url-input">
                                    <div id="demo-url-preview" class="url-preview hidden">
                                        <a href="#" class="url-link" target="_blank">Abrir link</a>
                                        <button type="button" class="text-btn edit-url-btn">(Editar)</button>
                                    </div>
                                </div>
                            </div>
                            <h4>Actividades de Preparaci√≥n</h4>
                            <div class="table-container small">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Actividad / Responsable</th>
                                            <th>Comentarios</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="demo-activities-body"></tbody>
                                </table>
                            </div>
                            <button id="add-demo-activity-btn" class="secondary-btn small" style="margin-top: 1rem;">+
                                Agregar Actividad</button>

                            <div class="poc-form-section"
                                style="margin-top: 2rem; border-top: 1px solid var(--glass-border); padding-top: 1rem;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                    <h4 data-i18n="label_walkthrough" style="margin: 0;">Demo Walkthrough (Pasos)</h4>
                                </div>

                                <div class="walkthrough-container"
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="walkthrough-section">
                                        <h5 data-i18n="label_prep_steps"
                                            style="margin-bottom: 0.5rem; color: var(--brand-teal);">Preparaci√≥n (Antes)
                                        </h5>
                                        <div id="walkthrough-prep-body" class="dynamic-list"></div>
                                        <button id="add-walkthrough-prep-btn" class="text-btn small"
                                            style="margin-top: 0.5rem; color: var(--brand-teal);">+ A√±adir Paso</button>
                                    </div>
                                    <div class="walkthrough-section">
                                        <h5 data-i18n="label_flow_steps"
                                            style="margin-bottom: 0.5rem; color: var(--brand-orange);">Presentaci√≥n
                                            (Durante)</h5>
                                        <div id="walkthrough-flow-body" class="dynamic-list"></div>
                                        <button id="add-walkthrough-flow-btn" class="text-btn small"
                                            style="margin-top: 0.5rem; color: var(--brand-orange);">+ A√±adir
                                            Paso</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-actions" style="margin-top: 2rem;">
                                <button id="save-demo-btn" class="primary-btn">Guardar Demo</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal for PoC Detail (Add/Edit) -->
            <div id="poc-detail-modal" class="modal hidden">
                <div class="modal-content large">
                    <div class="modal-header">
                        <h3 id="poc-detail-title">Detalle de Prueba de Concepto (PoC)</h3>
                        <button id="close-poc-detail-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="poc-form-section">
                            <h4>1. Resumen Ejecutivo</h4>
                            <div class="form-group">
                                <label>Proof of Concept Objective</label>
                                <textarea id="poc-objective" placeholder="Objetivo de la PoC..." rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Proof of Concept Primary Use Case</label>
                                <textarea id="poc-use-case" placeholder="Caso de uso principal..." rows="2"></textarea>
                            </div>
                        </div>

                        <div class="poc-form-section">
                            <h4>2. Alcance y Cronograma</h4>
                            <div class="form-group">
                                <label>Proof of Concept Scope Summary</label>
                                <div id="poc-scope-container" class="dynamic-list"></div>
                                <button type="button" class="secondary-btn small add-list-item" data-type="scope">+
                                    Agregar Alcance</button>
                            </div>
                            <div class="form-group">
                                <label>Timeline</label>
                                <div class="table-container small">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Actividad</th>
                                                <th>Fecha Milestone</th>
                                                <th>Estado / Comentarios</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody id="poc-timeline-body"></tbody>
                                    </table>
                                </div>
                                <button type="button" class="secondary-btn small" id="add-poc-timeline-btn">+ Agregar
                                    Milestone</button>
                            </div>
                        </div>

                        <div class="poc-form-section">
                            <h4>3. Equipo y Recursos</h4>
                            <div class="form-group">
                                <label>Proof of Concept Resources</label>
                                <div id="poc-resources-container" class="dynamic-list"></div>
                                <button type="button" class="secondary-btn small add-list-item" data-type="resources">+
                                    Agregar Recurso</button>
                            </div>
                            <div class="two-col-grid">
                                <div class="form-group">
                                    <label>Stakeholders (Cliente)</label>
                                    <div id="poc-stakeholders-container" class="dynamic-list"></div>
                                    <button type="button" class="secondary-btn small add-list-item"
                                        data-type="stakeholders">+ Agregar Stakeholder</button>
                                </div>
                                <div class="form-group">
                                    <label>Squad (Interno)</label>
                                    <div id="poc-squad-container" class="dynamic-list"></div>
                                    <button type="button" class="secondary-btn small add-list-item" data-type="squad">+
                                        Agregar Miembro Squad</button>
                                </div>
                            </div>
                        </div>

                        <div class="poc-form-section">
                            <h4>4. Log√≠stica y Finanzas</h4>
                            <div class="form-group">
                                <label>Assumptions</label>
                                <textarea id="poc-assumptions" placeholder="Supuestos y premisas..."
                                    rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Financials</label>
                                <textarea id="poc-financials" placeholder="Detalles financieros..." rows="2"></textarea>
                            </div>
                        </div>

                        <div class="poc-form-section">
                            <h4>5. Documentaci√≥n</h4>
                            <div class="two-col-grid">
                                <div class="form-group">
                                    <label><img src="assets/cloud-icon.svg" class="onedrive-icon"> Documento de
                                        Aceptaci√≥n</label>
                                    <div class="url-field-wrapper">
                                        <input type="text" id="poc-url-acceptance" placeholder="https://..."
                                            class="url-input">
                                        <div id="poc-url-acceptance-preview" class="url-preview hidden">
                                            <a href="#" class="url-link" target="_blank">Abrir link</a>
                                            <button type="button" class="text-btn edit-url-btn">(Editar)</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label><img src="assets/cloud-icon.svg" class="onedrive-icon"> Material de la
                                        PoC</label>
                                    <div class="url-field-wrapper">
                                        <input type="text" id="poc-url-content" placeholder="https://..."
                                            class="url-input">
                                        <div id="poc-url-content-preview" class="url-preview hidden">
                                            <a href="#" class="url-link" target="_blank">Abrir link</a>
                                            <button type="button" class="text-btn edit-url-btn">(Editar)</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions"
                            style="margin-top: 2rem; display: flex; justify-content: flex-end; gap: 1rem;">
                            <button id="download-docx-btn" class="secondary-btn hidden"
                                style="background: rgba(255, 66, 0, 0.1); color: var(--brand-orange); border-color: var(--brand-orange);">
                                <i class="fas fa-file-word"></i> Descargar DOCX</button>
                            <button id="view-fo-ticket-btn" class="secondary-btn hidden"
                                style="background: rgba(255, 66, 0, 0.1); color: var(--brand-orange); border-color: var(--brand-orange);">
                                <i class="fas fa-file-pdf"></i> Previsualizar PDF</button>
                            <button id="generate-fo-ticket-btn" class="secondary-btn"
                                style="background: rgba(0, 120, 215, 0.1); color: #0078d7; border-color: #0078d7;">
                                <i class="fas fa-sync"></i> Generar Documento</button>
                            <button id="save-poc-detail-btn" class="primary-btn">Guardar Prueba de Concepto</button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Migration Question Modal -->
            <div id="migration-modal" class="modal hidden">
                <div class="modal-content small">
                    <div class="modal-header">
                        <h3>Migrar Datos</h3>
                    </div>
                    <div class="modal-body">
                        <p>¬øDeseas copiar todos los archivos de configuraci√≥n existentes a la nueva carpeta?</p>
                        <div class="form-actions">
                            <button id="no-migrate-btn" class="secondary-btn">No, empezar de cero</button>
                            <button id="yes-migrate-btn" class="primary-btn">S√≠, copiar archivos</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Opportunity Details Modal -->
            <div id="details-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="details-modal-title" data-i18n="modal_details_title">Detalles de la Oportunidade</h2>
                        <button class="close-modal-btn" id="close-details-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <!-- Modal Tabs -->
                        <div class="modal-tabs">
                            <button class="tab-btn active" data-tab="general" data-i18n="tab_general">General</button>
                            <button class="tab-btn" data-tab="meddpicc" data-i18n="tab_meddpicc">MEDDPICC</button>
                        </div>

                        <!-- General Tab Content -->
                        <div id="tab-general" class="tab-content active">
                            <div id="details-content" class="details-grid">
                                <!-- Dynamic labels and values -->
                            </div>
                            <div class="opportunity-overview">
                                <h4 data-i18n="label_opp_explanation">Explicaci√≥n de la Oportunidad</h4>
                                <textarea id="opp-description"
                                    placeholder="Escribe aqu√≠ de qu√© trata esta oportunidad..."></textarea>
                                <div class="form-actions">
                                    <button id="save-opp-description-btn" class="primary-btn small"
                                        data-i18n="btn_save_explanation">Guardar
                                        Explicaci√≥n</button>
                                </div>
                            </div>
                        </div>

                        <!-- MEDDPICC Tab Content -->
                        <div id="tab-meddpicc" class="tab-content">
                            <div class="meddpicc-sub-tabs">
                                <button class="sub-tab-btn active" data-sub-tab="m">M</button>
                                <button class="sub-tab-btn" data-sub-tab="e">E</button>
                                <button class="sub-tab-btn" data-sub-tab="d1">D</button>
                                <button class="sub-tab-btn" data-sub-tab="d2">D</button>
                                <button class="sub-tab-btn" data-sub-tab="p">P</button>
                                <button class="sub-tab-btn" data-sub-tab="i">I</button>
                                <button class="sub-tab-btn" data-sub-tab="c">C</button>
                                <button class="sub-tab-btn" data-sub-tab="c2">C</button>
                            </div>

                            <div class="meddpicc-content">
                                <div id="sub-tab-m" class="sub-tab-pane active">
                                    <div class="form-group">
                                        <label data-i18n="label_metrics">M - Metrics</label>
                                        <textarea id="medd-m" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-e" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_economic_buyer">E - Economic Buyer</label>
                                        <textarea id="medd-e" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-d1" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_decision_criteria">D - Decision Criteria</label>
                                        <textarea id="medd-d1" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-d2" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_decision_process">D - Decision Process</label>
                                        <textarea id="medd-d2" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-p" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_paper_process">P - Paper Process</label>
                                        <textarea id="medd-p" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-i" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_implicate_pain">I - Implicate Pain</label>
                                        <textarea id="medd-i" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-c" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_champion">C - Champion</label>
                                        <textarea id="medd-c" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                                <div id="sub-tab-c2" class="sub-tab-pane">
                                    <div class="form-group">
                                        <label data-i18n="label_competition">C - Competition</label>
                                        <textarea id="medd-c2" data-i18n="placeholder_meddpicc"
                                            data-i18n-prop="placeholder" rows="8"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 1rem;">
                                <button id="save-meddpicc-btn" class="primary-btn" data-i18n="btn_save_meddpicc">Guardar
                                    MEDDPICC</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Update Confirmation Modal -->
            <div id="update-modal" class="modal hidden">
                <div class="modal-content small">
                    <div class="modal-header">
                        <h3>Actualizaci√≥n de Software</h3>
                        <button id="close-update-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p id="update-message">Una nueva versi√≥n est√° disponible. ¬øDeseas descargarla e instalarla
                            ahora?</p>
                        <div class="form-actions" style="margin-top: 1.5rem;">
                            <button id="cancel-update-btn" class="secondary-btn">M√°s tarde</button>
                            <button id="confirm-update-btn" class="primary-btn">Actualizar Ahora</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Attack Plan Modal -->
            <div id="attack-plan-modal" class="modal hidden">
                <div class="modal-content large">
                    <div class="modal-header">
                        <h3 id="attack-plan-modal-title">Plan de Ataque: Nombre de Cuenta</h3>
                        <button id="close-attack-plan-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="poc-form-section">
                            <h4>1. Licencias y Vol√∫menes</h4>
                            <div id="attack-plan-licenses-container" class="dynamic-list">
                                <!-- Licenses injected here -->
                            </div>
                            <button id="add-attack-license-btn" class="secondary-btn small">+ Agregar Licencia</button>
                        </div>

                        <div class="poc-form-section">
                            <h4>2. Cronograma de Actividades</h4>
                            <div class="table-container small">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Actividad</th>
                                            <th>Inicio</th>
                                            <th>Fin</th>
                                            <th>Comentarios</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="attack-plan-activities-body">
                                        <!-- Activities injected here -->
                                    </tbody>
                                </table>
                            </div>
                            <button id="add-attack-activity-btn" class="secondary-btn small" style="margin-top: 1rem;">+
                                Agregar Actividad</button>

                            <!-- Timeline Chart Section -->
                            <div class="timeline-chart-section" style="margin-top: 2rem;">
                                <h4>Visualizaci√≥n de Timeline</h4>
                                <div id="attack-plan-timeline-chart" class="timeline-chart-container">
                                    <!-- Timeline bars will be injected here -->
                                </div>
                            </div>
                        </div>

                        <div class="poc-form-section">
                            <h4>3. Estrategia de Ataque</h4>
                            <div class="form-group">
                                <textarea id="attack-plan-strategy"
                                    placeholder="Define aqu√≠ la estrategia para esta cuenta..." rows="6"></textarea>
                            </div>
                        </div>

                        <div class="form-actions" style="margin-top: 2rem;">
                            <button id="save-attack-plan-btn" class="primary-btn">Guardar Plan de Ataque</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Contacts Modal -->
            <div id="account-contacts-modal" class="modal hidden">
                <div class="modal-content large" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h2 id="account-contacts-modal-title">Contactos de la Cuenta</h2>
                        <button id="close-account-contacts-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="poc-form-section">
                            <h4>Listado de Contactos</h4>
                            <div class="table-container small">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Nombre</th>
                                            <th>Posici√≥n</th>
                                            <th>Email</th>
                                            <th>Tel√©fono</th>
                                            <th>Influencia</th>
                                            <th>Comentarios</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="account-contacts-body">
                                        <!-- Contacts injected here -->
                                    </tbody>
                                </table>
                            </div>
                            <button id="add-account-contact-btn" class="secondary-btn small" style="margin-top: 1rem;">+
                                Agregar Contacto</button>
                        </div>

                        <div class="form-actions" style="margin-top: 2rem;">
                            <button id="save-account-contacts-btn" class="primary-btn">Guardar Contactos</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resource Modal -->
            <div id="resource-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="resource-modal-title" data-i18n="modal_resource_title">Nuevo Recurso</h2>
                        <button id="close-resource-modal-btn" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label data-i18n="label_resource_name">Nombre del Recurso</label>
                            <input type="text" id="resource-name-input" class="form-input"
                                data-i18n="placeholder_resource_name" data-i18n-prop="placeholder">
                        </div>
                        <div class="form-group">
                            <label data-i18n="label_resource_content">Enlace / Email / Nota</label>
                            <textarea id="resource-content-input" class="form-input" rows="3"
                                data-i18n="placeholder_resource_content" data-i18n-prop="placeholder"></textarea>
                        </div>
                        <div class="form-actions">
                            <button id="save-resource-btn" class="primary-btn"
                                data-i18n="btn_save_settings">Guardar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ticket View Modal -->
            <div id="ticket-view-modal" class="modal hidden">
                <div class="modal-content large"
                    style="height: 90vh; display: flex; flex-direction: column; padding: 0;">
                    <div class="modal-header"
                        style="padding: 1.2rem 2rem; background: var(--bg-card); border-bottom: 1px solid var(--glass-border); display: flex; align-items: flex-start; justify-content: space-between;">
                        <div style="flex: 1;">
                            <h3 id="ticket-view-title" style="margin: 0;">Vista de Ticket FO</h3>
                            <p id="ticket-view-url"
                                style="font-size: 0.8rem; color: var(--text-dim); margin: 0.3rem 0 0 0; word-break: break-all; font-family: monospace;">
                            </p>
                        </div>
                        <button id="close-ticket-view-btn" class="close-btn"
                            style="margin-top: -0.5rem;">&times;</button>
                    </div>
                    <div id="ticket-preview-container"
                        style="flex: 1; position: relative; background: #fff; overflow: hidden;">
                        <iframe id="ticket-iframe" style="width: 100%; height: 100%; border: none;"></iframe>
                    </div>
                </div>
            </div>

            <!-- Success Overlay -->
            <div id="success-toast" class="toast hidden" data-i18n="toast_success_update">
                ¬°Actualizado con √©xito!
            </div>

            <datalist id="responsibles-list"></datalist>
        </main>
    </div>

    <script src="node_modules/papaparse/papaparse.min.js"></script>
    <script src="translations.js"></script>
    <script src="renderer.js"></script>
</body>

</html>